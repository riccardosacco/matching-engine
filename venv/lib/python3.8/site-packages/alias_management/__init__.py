from elasticsearch_metadata import ElasticSearch

class AliasManagement(ElasticSearch):
  def __init__(self, url, index):
    super().__init__(url, index)

  def get_document_by_UUID(self, masterUUID):
    """Get document by UUID

    Args:
        masterUUID (string): Master UUID

    Returns:
        object: ES object
    """

    # Create query by masterUUID
    queryUUID = {
      "query": {
        "match": {
          "masterUUID": masterUUID
        }
      }
    }

    # Query ES
    result = self.query(query=queryUUID, params="_search")

    # If document is found
    if(len(result["hits"]["hits"]) != 0):
      document = result["hits"]["hits"][0]["_source"]
    else:
      document = {}

    return document

  def create_alias(self, masterUUID, aliasUUID):
    return True

  def unalias(self, masterUUID, aliasUUID):
    return True