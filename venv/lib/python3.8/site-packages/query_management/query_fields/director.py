def generate_director(query_director):
  query_director = query_director.replace(".", "")
  splitDirector = query_director.split(" ")  

  dismax_director = {"dis_max": {"queries": []}}

  directorFuzzy1String = ""
  directorFuzzyString = ""

  for director in splitDirector:
    directorFuzzy1String += director + "~1 "
    directorFuzzyString += director + "~ "

    initials = director[0]
    initialsDiractorFuzzyString = ""

    for director2 in splitDirector:
        if (director2 != director):
            initialsDiractorFuzzyString += director2 + "~ "
        else:
            initialsDiractorFuzzyString += initials + "* "
    director_InitialsFuzzy = {
        "script_score": {
            "query": {
                "simple_query_string": {
                    "query": initialsDiractorFuzzyString,
                    "fields": ["providerData.director"],
                    "default_operator": "AND",
                },
            },
            "script": {
                "source":
                "25*((_score/doc['providerData.director.length'].value)*doc['providerData.director.length'].value)/(((1-(_score/doc['providerData.director.length'].value))*doc['providerData.director.length'].value)+" +
                str(len(splitDirector)) +
                ")",
            },
        },
    }
    dismax_director["dis_max"]["queries"].append(director_InitialsFuzzy)

  director_ORFuzzy1 = {
      "script_score": {
          "query": {
              "simple_query_string": {
                  "query": directorFuzzy1String,
                  "fields": ["providerData.director"],
                  "default_operator": "OR",
              },
          },
          "script": {
              "source":
              "20*((_score/doc['providerData.director.length'].value)*doc['providerData.director.length'].value)/(((1-(_score/doc['providerData.director.length'].value))*doc['providerData.director.length'].value)+" +
              str(len(splitDirector)) +
              ")",
          },
      },
  }
  director_ORFuzzy = {
      "script_score": {
          "query": {
              "simple_query_string": {
                  "query": directorFuzzyString,
                  "fields": ["providerData.director"],
                  "default_operator": "OR",
              },
          },
          "script": {
              "source":
              "10*((_score/doc['providerData.director.length'].value)*doc['providerData.director.length'].value)/(((1-(_score/doc['providerData.director.length'].value))*doc['providerData.director.length'].value)+" +
              str(len(splitDirector)) +
              ")",
          },
      },
  }

  dismax_director["dis_max"]["queries"].append(director_ORFuzzy1)
  dismax_director["dis_max"]["queries"].append(director_ORFuzzy)

  return dismax_director
